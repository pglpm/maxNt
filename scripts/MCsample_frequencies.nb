(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48437,       1232]
NotebookOptionsPosition[     41368,       1116]
NotebookOutlinePosition[     41710,       1131]
CellTagsIndexPosition[     41667,       1128]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"NS", "[", 
   RowBox[{
   "\"\<MCsample_frequencies\>\"", ",", 
    "\"\<C:\\\\Users\\\\pglpm\\\\repositories\\\\maxNt\\\\scripts\\\\\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.757149763195278*^9, {3.7581811639819636`*^9, 3.7581811707055755`*^9}, {
   3.7647738301343384`*^9, 3.7647738322374587`*^9}, {3.764826791201255*^9, 
   3.764826796411664*^9}, {3.766729744525225*^9, 3.766729746969365*^9}, {
   3.7667377804448533`*^9, 3.766737785224127*^9}, {3.766853067679757*^9, 
   3.766853071171957*^9}, {3.7699186255283613`*^9, 
   3.769918625798377*^9}},ExpressionUUID->"1ae783fd-c3e5-4c9d-b598-\
2e4070aaf947"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f0", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{
    "Import", "[", "\"\<stensola2_6mom_prior2_N1000.csv\>\"", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7668531060689526`*^9, 3.7668531114482603`*^9}, {
  3.7668534034359612`*^9, 3.766853418424819*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"8f862eee-fd9d-4d00-a5f3-61cd71706bfb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", "f0"}]], "Input",
 CellChangeTimes->{{3.766853419424876*^9, 3.766853423977136*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"a37c51df-2b8f-454d-903b-a9797d89f3dd"],

Cell[BoxData["1001"], "Output",
 CellChangeTimes->{3.7668534243281565`*^9, 3.7668933055417876`*^9, 
  3.7669168340481243`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"bff0734d-1c18-40eb-b712-cafc6bc0a60b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fs", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{
    "Import", "[", "\"\<stensola_activity_freqs_bins417641.csv\>\"", 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7668534554399357`*^9, 3.7668534563749895`*^9}, {
  3.7668535761188383`*^9, 3.7668535964209995`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"53b8d9c8-3171-402e-8f94-c6ee205a7da4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{
    RowBox[{"Length", "@", "fs"}], "-", "1"}]}], ";", 
  RowBox[{"nn", "=", 
   RowBox[{
    RowBox[{"Length", "@", "f0"}], "-", "1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766853634454175*^9, 3.766853650698104*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"a47c96d7-34a8-4804-acb7-2da76f5f22b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gm", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Binomial", "[", 
       RowBox[{"n", ",", "a"}], "]"}], "*", 
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"nn", "-", "n"}], ",", 
         RowBox[{"aa", "-", "a"}]}], "]"}], "/", 
       RowBox[{"Binomial", "[", 
        RowBox[{"nn", ",", "aa"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aa", ",", "0", ",", "nn"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7668536083986845`*^9, 3.766853611407857*^9}, {
  3.766853663116814*^9, 3.7668537213381443`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"b8bd119e-5035-4a37-85e1-360aa0ca75c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"gm", ".", "f0"}], "-", "fs"}], ")"}], "/", "fs"}], ",", 
      "fs"}], "}"}], "//", "T"}], "//", "MF"}], ";"}]], "Input",
 CellChangeTimes->{{3.7668537457845426`*^9, 3.766853806072991*^9}, {
  3.766853845267233*^9, 3.766853855639826*^9}, {3.7668538861895733`*^9, 
  3.76685391165903*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"9909d4c9-d014-4a19-8c45-0110460c9630"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fx", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Unique", "[", "\"\<xx\>\"", "]"}], ",", 
     RowBox[{"nn", "+", "1"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766853935375386*^9, 3.766853954788497*^9}, {
  3.766854707625557*^9, 3.7668547442986546`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"2f88fc1b-6430-4f1f-a1e5-7e4818e936f9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fx", "[", 
  RowBox[{"[", 
   RowBox[{";;", "5"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7669168443285418`*^9, 3.7669168474485474`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"86a87d46-6005-42cf-b094-72951874def6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "xx1012", ",", "xx1013", ",", "xx1014", ",", "xx1015", ",", "xx1016"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.766916847744948*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"50ecd6c5-b40c-417d-b6cd-19dc48f3c421"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"solf", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gm", ".", "fx"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"Total", "[", "fx", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
      "fx"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766853966644175*^9, 3.7668540034862823`*^9}, {
   3.766854108958315*^9, 3.766854113982602*^9}, {3.766854210087099*^9, 
   3.7668542127162495`*^9}, {3.766854381392897*^9, 3.7668543893063498`*^9}, {
   3.766854450028823*^9, 3.7668544529179883`*^9}, {3.7668544987956123`*^9, 
   3.766854505128975*^9}, 3.76685479002127*^9, {3.7668553047027073`*^9, 
   3.7668553096799927`*^9}, {3.7668555134576473`*^9, 
   3.7668555511988063`*^9}, {3.766893666838422*^9, 3.766893669053626*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"2578517b-ee19-48f6-b076-c0d0bd155acb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{"\"\<solf\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"solf", ",", "fx"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.766893778472218*^9, 3.7668937979410524`*^9}, {
  3.766916516506566*^9, 3.766916519548571*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"20c189ec-089c-408f-883e-55eddc84a061"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<solf.m\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.766916542870612*^9, 3.766916546599019*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"047fb61e-9a0f-4f38-89c0-477fa5dc2e45"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fxd", "=", 
  RowBox[{"solf", "[", 
   RowBox[{"[", 
    RowBox[{";;", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7668555641115446`*^9, 3.7668556106082044`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"6ecba3c7-334e-406e-a4d1-72aa9ad9e8a7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "xx1947", ",", "xx1948", ",", "xx1949", ",", "xx1950", ",", "xx1951", ",", 
   "xx1952", ",", "xx1953", ",", "xx1954", ",", "xx1955", ",", "xx1956", ",", 
   "xx1957", ",", "xx1958", ",", "xx1959", ",", "xx1960", ",", "xx1961", ",", 
   "xx1962", ",", "xx1963", ",", "xx1964", ",", "xx1965", ",", "xx1966", ",", 
   "xx1967", ",", "xx1968", ",", "xx1969", ",", "xx1970", ",", "xx1971", ",", 
   "xx1972", ",", "xx1973", ",", "xx1974", ",", "xx1975", ",", "xx1976", ",", 
   "xx1977", ",", "xx1978", ",", "xx1979", ",", "xx1980", ",", "xx1981", ",", 
   "xx1982", ",", "xx1983", ",", "xx1984", ",", "xx1985", ",", "xx1986", ",", 
   "xx1987", ",", "xx1988", ",", "xx1989", ",", "xx1990", ",", "xx1991", ",", 
   "xx1992", ",", "xx1993", ",", "xx1994", ",", "xx1995", ",", "xx1996", ",", 
   "xx1997", ",", "xx1998", ",", "xx1999", ",", "xx2000", ",", "xx2001", ",", 
   "xx2002", ",", "xx2003", ",", "xx2004", ",", "xx2005", ",", "xx2006", ",", 
   "xx2007", ",", "xx2008", ",", "xx2009", ",", "xx2010", ",", "xx2011", ",", 
   "xx2012"}], "}"}]], "Output",
 CellChangeTimes->{{3.766855566856702*^9, 3.766855612061288*^9}, 
   3.766857823390768*^9, 3.7668580896669984`*^9, 3.7668933585662804`*^9, 
   3.7668938087050714`*^9, 3.766916954886936*^9, 3.7669939215516806`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"156e6e2c-68b7-4dfb-a955-8a9933ebdec6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fxtest", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", "7"}], "]"}]}], ";", 
  RowBox[{"solftest", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RandomInteger", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "7"}], "}"}]}], "]"}], ".", "fxtest"}], 
         "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"Total", "[", "fxtest", "]"}], "\[Equal]", "0"}]}], "}"}], 
      ",", "fxtest"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.766894494016275*^9, 3.7668945449191647`*^9}, {
  3.766894580877228*^9, 3.7668945848240347`*^9}, {3.7668946256503067`*^9, 
  3.7668946328263187`*^9}, {3.7668946833704076`*^9, 3.7668946931516247`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"678c5c34-0ec1-4337-9992-37dd54551eb5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "4", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"15", " ", 
        RowBox[{"a", "[", "1", "]"}]}], "7"]}], "-", 
     FractionBox[
      RowBox[{"10", " ", 
       RowBox[{"a", "[", "2", "]"}]}], "7"], "-", 
     FractionBox[
      RowBox[{"129", " ", 
       RowBox[{"a", "[", "3", "]"}]}], "14"]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "5", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"a", "[", "1", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"a", "[", "2", "]"}]}], "-", 
     FractionBox[
      RowBox[{"19", " ", 
       RowBox[{"a", "[", "3", "]"}]}], "2"]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "6", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"a", "[", "1", "]"}], "7"]}], "-", 
     FractionBox[
      RowBox[{"10", " ", 
       RowBox[{"a", "[", "2", "]"}]}], "7"], "-", 
     FractionBox[
      RowBox[{"17", " ", 
       RowBox[{"a", "[", "3", "]"}]}], "14"]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "7", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{"23", " ", 
       RowBox[{"a", "[", "1", "]"}]}], "7"], "+", 
     FractionBox[
      RowBox[{"27", " ", 
       RowBox[{"a", "[", "2", "]"}]}], "7"], "+", 
     FractionBox[
      RowBox[{"265", " ", 
       RowBox[{"a", "[", "3", "]"}]}], "14"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7668945455587654`*^9, 3.766894585292035*^9, 
  3.76689463335672*^9, 3.7668946943060265`*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"a5b95866-f945-46f3-aa84-9fe350d2d1c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fxdtest", "=", 
  RowBox[{"solftest", "[", 
   RowBox[{"[", 
    RowBox[{";;", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7668945893324423`*^9, 3.7668946186614943`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"44161e21-70ff-4b77-8eb8-d7475788cbac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", "[", "4", "]"}], ",", 
   RowBox[{"a", "[", "5", "]"}], ",", 
   RowBox[{"a", "[", "6", "]"}], ",", 
   RowBox[{"a", "[", "7", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.766894600439662*^9, 3.7668946397527313`*^9}, 
   3.7668946960064297`*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"e556a01c-8b79-42fc-8742-6185a2beff63"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fxitest", "=", 
  RowBox[{"Complement", "[", 
   RowBox[{"fxtest", ",", "fxdtest"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7668946206738977`*^9, 3.766894657255962*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"e70d0437-747b-4e30-98a2-2877dfbf8668"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], ",", 
   RowBox[{"a", "[", "2", "]"}], ",", 
   RowBox[{"a", "[", "3", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.766894651109551*^9, 3.7668946576459627`*^9}, 
   3.7668946994540358`*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"d2e486ef-9b75-46de-ba3c-e1d103224cfd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"(", 
   RowBox[{"fxtest", "/.", "solftest"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.766893998229804*^9, 3.766894011255827*^9}, {
  3.7668947158496647`*^9, 3.7668947190164704`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"c2118bf5-95b7-49bb-87f5-a780ec88f93c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], ",", 
   RowBox[{"a", "[", "2", "]"}], ",", 
   RowBox[{"a", "[", "3", "]"}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"15", " ", 
       RowBox[{"a", "[", "1", "]"}]}], "7"]}], "-", 
    FractionBox[
     RowBox[{"10", " ", 
      RowBox[{"a", "[", "2", "]"}]}], "7"], "-", 
    FractionBox[
     RowBox[{"129", " ", 
      RowBox[{"a", "[", "3", "]"}]}], "14"]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"a", "[", "2", "]"}]}], "-", 
    FractionBox[
     RowBox[{"19", " ", 
      RowBox[{"a", "[", "3", "]"}]}], "2"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"a", "[", "1", "]"}], "7"]}], "-", 
    FractionBox[
     RowBox[{"10", " ", 
      RowBox[{"a", "[", "2", "]"}]}], "7"], "-", 
    FractionBox[
     RowBox[{"17", " ", 
      RowBox[{"a", "[", "3", "]"}]}], "14"]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"23", " ", 
      RowBox[{"a", "[", "1", "]"}]}], "7"], "+", 
    FractionBox[
     RowBox[{"27", " ", 
      RowBox[{"a", "[", "2", "]"}]}], "7"], "+", 
    FractionBox[
     RowBox[{"265", " ", 
      RowBox[{"a", "[", "3", "]"}]}], "14"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.766894720404873*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"45f2d538-4e94-4945-8b6f-ce73f198e231"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", "test", "]"}]], "Input",
 CellChangeTimes->{{3.7668947731797657`*^9, 3.7668947748801684`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"d8fd1d1e-1a16-46bb-ba37-aab144a9564b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.766894775207769*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"8df7532e-086d-49d8-b392-d3efc2220690"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testt", "=", 
  RowBox[{"(", 
   RowBox[{"test", "/.", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Rule", ",", 
      RowBox[{"{", 
       RowBox[{"fxitest", ",", 
        RowBox[{"Rationalize", "[", 
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.000000000001"}], ",", "0.000000000001"}], "}"}],
             ",", 
            RowBox[{"Length", "@", "fxitest"}]}], "]"}], ",", "0"}], "]"}]}], 
       "}"}]}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.766894020397443*^9, 3.7668940645611205`*^9}, {
  3.7668941322028394`*^9, 3.7668942387510266`*^9}, {3.7668942837103057`*^9, 
  3.7668942859099092`*^9}, {3.766894446794992*^9, 3.7668944489009957`*^9}, {
  3.7668947380953035`*^9, 3.766894754709333*^9}, {3.7668948154870396`*^9, 
  3.7668948177178435`*^9}, {3.766894918775821*^9, 3.766894925530633*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"fe3cea40-eeb5-416d-9105-1599584f7532"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["35", "104135097228978"], ",", 
   FractionBox["65", "165667101016921"], ",", 
   FractionBox["112", "135734765917105"], ",", 
   RowBox[{"-", 
    FractionBox["48539954522855859728668834412979", 
     "5463881641732499894021835419665719873574810"]}], ",", 
   RowBox[{"-", 
    FractionBox["10883732574708143827317396689141", 
     "1170831780371249977290393304214082830051745"]}], ",", 
   RowBox[{"-", 
    FractionBox["26398302168951163512318845302751", 
     "16391644925197499682065506258997159620724430"]}], ",", 
   FractionBox["59784893439254663096507272675079", 
    "3278328985039499936413101251799431924144886"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.766894755192934*^9, {3.7668947857065873`*^9, 3.766894818295045*^9}, 
   3.7668949263886347`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"42dfd50d-a987-45a0-b273-723d65304643"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "@", "testt"}]], "Input",
 CellChangeTimes->{{3.766894214477384*^9, 3.7668942181277905`*^9}, {
  3.7668942677670774`*^9, 3.7668942791394978`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"6396f468-abf8-4a84-9eaa-3af470af5949"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.766894218673791*^9, {3.7668942618234673`*^9, 3.766894306189945*^9}, 
   3.7668944700234327`*^9, {3.766894757548538*^9, 3.766894819683447*^9}, 
   3.7668949281358376`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"14a62c8e-265c-4006-bfc2-e45d074e71e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", "fxd"}]], "Input",
 CellChangeTimes->{{3.766855658049918*^9, 3.7668556611880975`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"b62eb94f-2922-4e6d-9026-13b31c1183ec"],

Cell[BoxData["66"], "Output",
 CellChangeTimes->{3.7668556615791197`*^9, 3.7668578376555843`*^9, 
  3.7668580911330824`*^9, 3.7668933614834857`*^9, 3.76689381363468*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"6c39006d-05f4-4d9f-ac7f-83a3a4af6a49"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fxi", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{"fx", ",", "fxd"}], "]"}]}], ";", 
  RowBox[{"ni", "=", 
   RowBox[{"Length", "@", "fxi"}]}]}]], "Input",
 CellChangeTimes->{{3.7668556188586764`*^9, 3.7668556445181437`*^9}, {
  3.766856440422667*^9, 3.766856444514901*^9}, {3.766857062923272*^9, 
  3.7668570645563655`*^9}, {3.7668578422948494`*^9, 3.7668578434259143`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"5aca2d0b-d32a-4059-a1cb-0000c24ba1e5"],

Cell[BoxData["935"], "Output",
 CellChangeTimes->{3.76685644554696*^9, 3.766857064974389*^9, 
  3.7668578453340235`*^9, 3.766858092164141*^9, 3.7668933644474907`*^9, 
  3.76689381959389*^9, 3.7669169654325547`*^9, 3.7669939298976955`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"18129f25-7978-454f-be83-bf87b715f0a2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"argument", "=", 
   RowBox[{"(", 
    RowBox[{"fx", "/.", "solf"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766893998229804*^9, 3.766894011255827*^9}, {
  3.7668949918629494`*^9, 3.766894993875353*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"49eb3064-eff9-4be0-b33a-bffde7e8db03"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testt", "=", 
   RowBox[{"(", 
    RowBox[{"test", "/.", 
     RowBox[{"MapThread", "[", 
      RowBox[{"Rule", ",", 
       RowBox[{"{", 
        RowBox[{"fxi", ",", 
         RowBox[{"Rationalize", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.000000001"}], ",", "0.000000001"}], "}"}], ",",
              "ni"}], "]"}], ",", "0"}], "]"}]}], "}"}]}], "]"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766894020397443*^9, 3.7668940645611205`*^9}, {
  3.7668941322028394`*^9, 3.7668942387510266`*^9}, {3.7668942837103057`*^9, 
  3.7668942859099092`*^9}, {3.766894446794992*^9, 3.7668944489009957`*^9}, {
  3.766894939009057*^9, 3.7668949462942696`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"dc90e001-d29c-46be-bce9-33173315d99a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "@", "testt"}]], "Input",
 CellChangeTimes->{{3.766894214477384*^9, 3.7668942181277905`*^9}, {
  3.7668942677670774`*^9, 3.7668942791394978`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"4ddc1206-b6bc-4050-ad3d-40331b7f2904"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.766894218673791*^9, {3.7668942618234673`*^9, 3.766894306189945*^9}, 
   3.7668944700234327`*^9, 3.7668949484782734`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"209d1212-c798-4f1e-9a79-9f14935ea083"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ord", "=", 
   RowBox[{"Ordering", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{"fxd", ",", "fxi"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7668578747697067`*^9, 3.7668579202323074`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"2bebf0d9-d374-47d0-aa28-2c44df36a366"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "repl", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repl", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "fxi", "]"}], ",", 
     RowBox[{"Evaluate", "[", "argument", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.766895042126238*^9, 3.766895046977846*^9}, {
  3.7668950886455193`*^9, 3.7668951060863504`*^9}, {3.7668971252320967`*^9, 
  3.76689713858572*^9}, {3.766897185042602*^9, 3.7668972280206776`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"3094f731-4e6d-433a-8f57-769431b0821f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"repl", "@@", 
   RowBox[{"(", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", "ni"}], "]"}], 
    ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.766857592236547*^9, 3.766857619072082*^9}, {
  3.7668581260030766`*^9, 3.7668581298302956`*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"81a45fa6-acd3-4eff-962c-0e38c7f7e0c8"],

Cell[BoxData["1001"], "Output",
 CellChangeTimes->{
  3.7668576196761165`*^9, {3.7668577084271927`*^9, 3.7668577191918087`*^9}, 
   3.7668580434573555`*^9, 3.7668580777213154`*^9, {3.7668581097261457`*^9, 
   3.7668581303483253`*^9}, 3.766893404305561*^9, {3.7668938359271193`*^9, 
   3.7668938509187455`*^9}, 3.766895052921457*^9, 3.766895107817953*^9, 
   3.7668954549497633`*^9, 3.7668970520835686`*^9, 3.766897141253325*^9},
 CellLabel->
  "Out[175]=",ExpressionUUID->"73870257-251a-488a-b803-9006d31e975d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"repl", "@@", 
    RowBox[{"(", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", "ni"}], "]"}], 
     ")"}]}], ")"}], "[", 
  RowBox[{"[", "1000", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7668972090354443`*^9, 3.7668972132162514`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"8b4f736b-4f3d-4c26-9803-650f5cdc7ea4"],

Cell[BoxData[
 RowBox[{"-", "1.724700698530916`*^104"}]], "Output",
 CellChangeTimes->{{3.766897213855852*^9, 3.766897232295085*^9}, 
   3.766916990454999*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"ada44444-c75c-4262-988e-cc5fa8ef6479"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"repl", "@@", 
   RowBox[{"(", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", "ni"}], "]"}], 
    ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.76689352327137*^9, 3.766893526266575*^9}, {
  3.7668935730822573`*^9, 3.766893575344261*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"be11e328-bea0-4d50-a1fe-9c4b6da5959c"],

Cell[BoxData[
 RowBox[{"-", "3.8834887352982884`*^105"}]], "Output",
 CellChangeTimes->{
  3.766893526718976*^9, 3.7668935757966623`*^9, {3.766893837440322*^9, 
   3.7668938563475547`*^9}, 3.7668950549494605`*^9, 3.7668951096275563`*^9, 
   3.766895457227367*^9, {3.766897173373781*^9, 3.766897197226223*^9}, 
   3.76689723525909*^9},
 CellLabel->
  "Out[187]=",ExpressionUUID->"cf659d53-f6a3-4bb3-bf0f-9de42e430ad0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fr", "=", 
   RowBox[{"2", "*", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "aa", "+", "nn"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nn", "+", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"nn", "+", "2"}], ")"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"aa", ",", "0", ",", "nn"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "fr"}]}], "Input",
 CellChangeTimes->{{3.7668557035915227`*^9, 3.7668557335152345`*^9}, {
  3.7668557658640842`*^9, 3.7668557662011037`*^9}, {3.7668586778806424`*^9, 
  3.7668586783786707`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"040f0077-d1d3-4039-9976-4145a6c7acf0"],

Cell[BoxData["1001"], "Output",
 CellChangeTimes->{3.766855767255164*^9, 3.766858148103341*^9, 
  3.766858678861698*^9, 3.766893438329221*^9, 3.766895117989171*^9, 
  3.7669169962738085`*^9, 3.76699394992813*^9, 3.766994322318385*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"1d9d4ae3-a64b-42a4-b659-7ce48f33fcd8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xlny", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x", ">", "0"}], ",", 
     RowBox[{"x", "*", 
      RowBox[{"Log", "[", 
       RowBox[{"x", "/", "y"}], "]"}]}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"xlny", ",", "Listable"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.766856065853243*^9, 3.7668561060755434`*^9}, {
  3.7668561468948784`*^9, 3.766856147387906*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"735e2752-6c4d-49b5-8a3e-34f107867fe5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{"xlny", "[", 
    RowBox[{"x", ",", "y"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.76685615706846*^9, 3.7668561759525404`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"de99fece-f95c-493f-97ab-82822b31bb6c"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.766858515449352*^9},ExpressionUUID->"573b6bb4-8e3d-41bb-8e80-\
da6e72455e4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<mcmc.m\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.760192714885389*^9, 3.760192747380246*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"8c9bc2df-c6f7-4b70-93bb-c33dada1533c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"logpr", "=", 
   RowBox[{"100", "*", 
    RowBox[{"h", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "/", 
          RowBox[{"Total", "@", "#"}]}], ")"}], "&"}], "@", 
       RowBox[{"(", 
        RowBox[{"f0", "+", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"argument", ",", "0"}], "]"}]}], ")"}]}], ",", "fr"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.751620204718171*^9, 3.7516202047221713`*^9}, 
   3.7516204106859474`*^9, {3.7516207513502254`*^9, 3.751620754488405*^9}, {
   3.752072322216852*^9, 3.7520723286908636`*^9}, {3.7520723910129733`*^9, 
   3.752072436923854*^9}, {3.752072739699273*^9, 3.752072751243294*^9}, {
   3.7520727863121552`*^9, 3.752072789556961*^9}, {3.7520728447342577`*^9, 
   3.7520728468402615`*^9}, {3.7520771366442947`*^9, 3.7520771382822976`*^9}, 
   3.7520862249740286`*^9, 3.752090705151121*^9, {3.752090913334487*^9, 
   3.752090913615288*^9}, 3.7520910100234566`*^9, {3.752125562841312*^9, 
   3.752125564510515*^9}, {3.752126013387704*^9, 3.752126015649708*^9}, {
   3.7521263321918635`*^9, 3.752126332878265*^9}, {3.752126822159524*^9, 
   3.7521268333447437`*^9}, {3.7521285809684143`*^9, 3.752128588206827*^9}, {
   3.7521293308023314`*^9, 3.752129331207932*^9}, {3.75212952349387*^9, 
   3.7521295729771566`*^9}, 3.7521297080899944`*^9, {3.752133498420433*^9, 
   3.7521334994968348`*^9}, {3.752133534347296*^9, 3.7521335356576986`*^9}, {
   3.7521336052806206`*^9, 3.7521336107874303`*^9}, {3.760192050530885*^9, 
   3.760192064654748*^9}, {3.7601924949406023`*^9, 3.7601925060010223`*^9}, {
   3.7601926076196003`*^9, 3.760192608103201*^9}, {3.7601926985677605`*^9, 
   3.7601927000497627`*^9}, {3.7602527972765756`*^9, 3.760252805029789*^9}, {
   3.766858601657283*^9, 3.7668586610566797`*^9}, {3.766858691181403*^9, 
   3.7668587443544445`*^9}, {3.7668951625272493`*^9, 3.766895170389663*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"bc9eccf5-77d3-4c82-8df2-2bf487eaa43e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"T", "[", 
    RowBox[{"{", 
     RowBox[{"fxi", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"10", "^", 
          RowBox[{"-", "4"}]}]}], ",", "ni"}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}], ",", "ni"}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"Reals", ",", "ni"}], "]"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7668587654116488`*^9, 3.7668588357416716`*^9}, {
  3.766858898758276*^9, 3.7668589097849064`*^9}, {3.7668952062385263`*^9, 
  3.7668952208089514`*^9}, {3.7668974124442015`*^9, 3.766897415486207*^9}, {
  3.7668975427668304`*^9, 3.766897544872834*^9}, {3.766897593170519*^9, 
  3.7668975958069234`*^9}, {3.7669192078462987`*^9, 3.766919210607504*^9}, {
  3.7669195692209334`*^9, 3.7669195727465396`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"a90f8cff-019b-4b5a-9ae5-acf70ca9b0d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nsamples", "=", "1000"}], ";", 
  RowBox[{"mcmc", "=", 
   RowBox[{"MCMC", "[", 
    RowBox[{"logpr", ",", "vars", ",", "nsamples"}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"\"\<ProgressMonitor\>\"", "\[Rule]", "None"}]}], "*)"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7520724797459292`*^9, 3.7520724941135545`*^9}, {
   3.752072853610674*^9, 3.7520729230775957`*^9}, {3.752073029844183*^9, 
   3.752073030936185*^9}, {3.7520765102543945`*^9, 3.7520765200356116`*^9}, {
   3.7521268639207973`*^9, 3.752126864076798*^9}, {3.752128417401127*^9, 
   3.7521284194447303`*^9}, {3.7521336171532416`*^9, 3.752133617278042*^9}, 
   3.7521531102461395`*^9, {3.7521532308977513`*^9, 3.7521532349381585`*^9}, {
   3.7521534370209136`*^9, 3.7521534374889145`*^9}, {3.760192532224668*^9, 
   3.760192552847904*^9}, {3.7601928113091583`*^9, 3.7601928142887635`*^9}, {
   3.7601933568889165`*^9, 3.7601933573101172`*^9}, {3.7601938070433073`*^9, 
   3.760193807604908*^9}, {3.7601939171171007`*^9, 3.760193927179118*^9}, {
   3.760252848756666*^9, 3.7602528525942726`*^9}, {3.7602582991420393`*^9, 
   3.7602584176866474`*^9}, {3.760263157195372*^9, 3.76026316179738*^9}, {
   3.766858842549061*^9, 3.7668588740858645`*^9}, 3.7668952481401997`*^9, {
   3.766896319708082*^9, 3.7668963201760826`*^9}, 3.766897353023697*^9, {
   3.766897441990653*^9, 3.766897448261864*^9}, 3.7669170099862328`*^9},
 CellLabel->
  "In[104]:=",ExpressionUUID->"33041250-f101-4837-9c2a-f26a1e084049"],

Cell[BoxData[
 RowBox[{
  RowBox[{"valuese", "=", 
   RowBox[{"mcmc", "[", "\"\<ParameterRun\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7601929803666553`*^9, 3.7601929873398676`*^9}, 
   3.76025286235989*^9},
 CellLabel->
  "In[105]:=",ExpressionUUID->"9c0cc924-4f18-44d1-b0f6-5e92af1bb3f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "valuese", "]"}]], "Input",
 CellChangeTimes->{{3.7668952588574185`*^9, 3.766895262055424*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"b87ba9dd-1bb0-4425-94ac-5463755e053e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1000", ",", "935"}], "}"}]], "Output",
 CellChangeTimes->{3.7668952624922247`*^9, 3.7668963309713016`*^9, 
  3.7668973822269483`*^9, 3.766897477012715*^9, 3.7668975738888845`*^9, 
  3.766897624230173*^9, 3.766918987729912*^9, 3.7669194577431374`*^9, 
  3.766919823969381*^9, 3.766994591309657*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"56b07ed1-cbef-477a-ae02-3d3604fa48ac"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfreqs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"repl", "@@", 
      RowBox[{"(", 
       RowBox[{"valuese", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "nsamples"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7668969679526205`*^9, 3.766896993333865*^9}, {
   3.7668972646183414`*^9, 3.766897272262355*^9}, 3.766897373584533*^9, {
   3.766897455484677*^9, 3.7668974566546793`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"93e9d11d-78da-4248-87ce-fd925f739f39"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freqs", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f0", "+", "#"}], ")"}], "&"}], "/@", "dfreqs"}], ",", "f0"}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7669943746096764`*^9, 3.7669943771680813`*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"8453237d-8417-4c98-85e6-77a939991323"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{"\"\<sampledfreqs1000e-4.m\>\"", ",", "freqs"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766897980146798*^9, 3.766898001409636*^9}, {
  3.766994357980047*^9, 3.7669943601172514`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"a7f65ea9-07dd-4c1c-ada5-d41b2e5b79cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<sampledfreqs1000e-3.m\>\""}], ";", 
  RowBox[{"nsamples", "=", "1000"}], ";"}]], "Input",
 CellChangeTimes->{{3.7669939596625476`*^9, 3.76699400072182*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"0611f0c7-40bc-4139-824e-8ce4ab5a6749"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", "1000"}], ";", 
  RowBox[{"rg", "=", "0.15"}], ";", 
  RowBox[{"plot", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"freqs", ",", "f0"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{";;", ";;", 
          RowBox[{"Round", "[", 
           RowBox[{"nsamples", "/", "100"}], "]"}]}], ",", 
         RowBox[{";;", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"rg", "*", "nn"}], "+", "1"}], "]"}]}]}], "]"}], "]"}], 
      "*", "nn"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"DataRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"rg", "*", "100"}]}], "}"}]}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", "\[FilledCircle]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"solid", ",", "Black", ",", 
            RowBox[{"Opacity", "[", "0.05", "]"}]}], "}"}], ",", "100"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"solid", ",", "blue", ",", 
          RowBox[{"Opacity", "[", "0.75", "]"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"Text", "[", 
       RowBox[{"\"\<N = 1000, 100 samples\>\"", ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"0.9", ",", "0.9"}], "}"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<total normalized activity/%\>\"", ",", 
        "\"\<frequency density\>\""}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "a4shortside"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expdf", "[", 
   RowBox[{"\"\<stensola_N1000_MCsamples_blue_r015\>\"", ",", "plot"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.766898732942721*^9, 3.766898782176407*^9}, {
  3.766898827541287*^9, 3.766898897133009*^9}, {3.766898975273546*^9, 
  3.76689897708315*^9}, {3.7669190056387434`*^9, 3.7669190171203637`*^9}, {
  3.766919115197736*^9, 3.766919173229838*^9}, {3.766924139473361*^9, 
  3.7669241828726373`*^9}, {3.7669242246495104`*^9, 3.7669242355695295`*^9}, {
  3.7669244830327644`*^9, 3.766924536306858*^9}, {3.766994034355479*^9, 
  3.7669940986431913`*^9}, {3.7669941611837015`*^9, 3.7669941989211683`*^9}, {
  3.7669942306682234`*^9, 3.766994235519832*^9}, {3.7669948322208805`*^9, 
  3.766994896291193*^9}, {3.7669949312664547`*^9, 3.7669949393004684`*^9}, {
  3.766994981155342*^9, 3.766994983885347*^9}, {3.766995078437113*^9, 
  3.7669951830820966`*^9}, {3.766995250739415*^9, 3.7669953487231874`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"b1d9d6a1-7afe-4eb8-8230-57c15443679c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expdf", "[", 
   RowBox[{"\"\<stensola_N1000_MCsamples_blue\>\"", ",", "plot"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7668986412613597`*^9, 3.7668987230523033`*^9}, {
   3.766898794500429*^9, 3.7668987960604315`*^9}, 3.7669195972385826`*^9, {
   3.766924553825689*^9, 3.7669245573512945`*^9}, {3.7669941919157553`*^9, 
   3.7669941925709567`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"e7ad441f-3299-4a3c-8eda-d73b0fabab45"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f0", ",", 
      RowBox[{"(", 
       RowBox[{"Mean", "@", "freqs"}], ")"}]}], "}"}], "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", 
      RowBox[{";;", "50"}]}], "]"}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7668976127017527`*^9, 3.7668976535582247`*^9}, {
  3.7668977785154448`*^9, 3.7668977789210453`*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"1767f6bd-80e8-4502-b536-ef6378470f27"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[
      NCache[
       Rational[2, 5], 0.4], 
      NCache[
       Rational[4, 5], 0.8], 
      NCache[
       Rational[14, 15], 0.9333333333333333]], PointSize[
      NCache[
       Rational[1, 72], 0.013888888888888888`]], Thickness[Large], 
     LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7H84KIhXbK63hwo4HNzENMmqbwKUz+EQLm3y
11ZoLpQv4ND7vTDiyLulUL6Iw6rM6NRmjrVQvoRD8hzBspUGG6F8GYdZ9aHn
47o3QfkKDp91Wu5nd8L4Sg71z8v+bi2AqVdxSLMI9DAIWw/lqzl8zd6/+KLN
aihfw8HnfJlziu5yKF/L4esvpiyZ5sVQvo6D7qze3GdpC6B8PQexR/UKLQdm
Q/kGDlYvQw4/OzEdyjd0eLL2zNGyQ1OgfCOHUo++hJS2SVC+scO3J+Xllz/C
wsPEIeYFK4v+hX4o39Th/IoVLb5L+6B8Mwf/yw8Y5tjD+OYOd8pl1zg0wvgW
Dmknpt3u94Hpt3RI/HmoZb8dzHwrhyy2T7HKcPusHc7+UXrhMmsilG/jUHq/
+CwjN8x9tg6JbCL/znLB+HYO7KL1biqJMPX2DsHzm122n4XZ5+Bg0bcm3Nu8
G8JvcHDwLXC9fCKrFSrv6PAnoG7hvrw6qLyjwz7RpzHWysVQeSeH1VK983hu
p0DlnRyev9jyicshGCrv7PDx1+vVVxNsofLODgbMWuZv+JWg8i4OrLOeb5XP
YoTKuziwHHkltGfqTTuIvKtDzWVFhYiTqyH8BleHNAXpV61zSqHybg71sqUC
Uz3NofJuDlxRpfoPTn6whci7O6gKmO9ysZkP4Te4O7RsXu/3iscJKu/h8KjT
f8+rVzdsIPIeDoJik0sXbE+G8Bk8HUz9mmTDVR5aAwAVndkV
      "]]}, 
    {RGBColor[
      NCache[
       Rational[14, 15], 0.9333333333333333], 
      NCache[
       Rational[2, 5], 0.4], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], PointSize[
      NCache[
       Rational[1, 72], 0.013888888888888888`]], Thickness[Large], 
     Dashing[{Small, Small}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7O+siGWctbJhP1TAQbrRxyB2Qpk9hMvhkLB0
o5nb/olQvoDDrO03Fv2btwTKF3HoPT5FitN5LZQv4aAzLdvdcOZqKF/GYXFn
y293y41QvoKDkahNW9nvdVC+ksP/Sp7pF9VgfBWHaNX+ipJrMP1qDsJ9vUXT
Xq6B8jUcfpxcZ2r/ezGUr+Uwg23RlcpzC6F8HYe1bwI3WZ2eC+XrORiKK+bc
sZkK5Rs4lIZaVwoW9EP5hg4Bn7iOrRKeAOUbOXxn2xQkH94I5Rs7JC+QTPl1
qxfKN3FwXcJZK/ezAMo3dSj1yQipet0G5Zs59OhtCFiW3Aflmzsk1hnV87d2
QPkWDmKbCnJ166qgfEuHql9XH9zZDzPfyqGkvFDtVlszlG/tsH5HflaOMcw9
Ng7+de7CIT0w/9g6xH/Man8i2wLl2zns0M883H0dJm/v0Fe0/HHVFph7HRxU
n2r23boOVd/g4FCufYSp7wnM/Y4OctF1DIYBdVB5R4d9TGEPT9o6QNOHk0PM
9x1GdxVLofJODurnZKYc3JEE1e/scI2Vt8J8cSdEfYOzw9EvQWuZCoOg8i4O
eUuzBfrEa6HyLg7nUz78fNAdAjXf1aFw5Wn1ZbujofKuDnnzL8wLnx4G1e/m
4PezJV/oYDhU3s2hSy3jUdXjIqh+d4em5ENFxh1Q/za4O9ztcvJ51NIMlfdw
qHzo/ad+Rj1U3sNhSo/Qh22rFKDmezoEL1Sesz4pxh4AXlfdfw==
      "]]}}, {}, {}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->Directive[
    GrayLevel[0], 21, 
    Thickness[
     NCache[
      Rational[1, 500], 0.002]], FontFamily -> Automatic],
  DisplayFunction->Identity,
  Frame->{{Automatic, Automatic}, {Automatic, Automatic}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Directive[
    GrayLevel[0], 21, 
    Thickness[
     Rational[1, 500]], FontFamily -> Automatic],
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  ImagePadding->All,
  ImageSize->NCache[
    Rational[75600, 127], 595.2755905511812],
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 50.}, {-0.012518342353021444`, 0.07243912279}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.7668976359145937`*^9, 3.7668976539950256`*^9}, {
  3.7668977640854187`*^9, 3.766897779326646*^9}},
 CellLabel->
  "Out[234]=",ExpressionUUID->"9053efaf-5572-43dd-9c9a-4aa983901bd7"]
}, Open  ]]
},
WindowSize->{640, 755},
WindowMargins->{{Automatic, 104}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (32-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 660, 14, 48, "Input",ExpressionUUID->"1ae783fd-c3e5-4c9d-b598-2e4070aaf947"],
Cell[1221, 36, 383, 10, 28, "Input",ExpressionUUID->"8f862eee-fd9d-4d00-a5f3-61cd71706bfb"],
Cell[CellGroupData[{
Cell[1629, 50, 199, 3, 28, "Input",ExpressionUUID->"a37c51df-2b8f-454d-903b-a9797d89f3dd"],
Cell[1831, 55, 204, 3, 32, "Output",ExpressionUUID->"bff0734d-1c18-40eb-b712-cafc6bc0a60b"]
}, Open  ]],
Cell[2050, 61, 390, 9, 28, "Input",ExpressionUUID->"53b8d9c8-3171-402e-8f94-c6ee205a7da4"],
Cell[2443, 72, 355, 9, 28, "Input",ExpressionUUID->"a47c96d7-34a8-4804-acb7-2da76f5f22b7"],
Cell[2801, 83, 783, 21, 48, "Input",ExpressionUUID->"b8bd119e-5035-4a37-85e1-360aa0ca75c3"],
Cell[3587, 106, 517, 14, 28, "Input",ExpressionUUID->"9909d4c9-d014-4a19-8c45-0110460c9630"],
Cell[4107, 122, 393, 9, 28, "Input",ExpressionUUID->"2f88fc1b-6430-4f1f-a1e5-7e4818e936f9"],
Cell[CellGroupData[{
Cell[4525, 135, 246, 5, 28, "Input",ExpressionUUID->"86a87d46-6005-42cf-b094-72951874def6"],
Cell[4774, 142, 254, 6, 32, "Output",ExpressionUUID->"50ecd6c5-b40c-417d-b6cd-19dc48f3c421"]
}, Open  ]],
Cell[5043, 151, 943, 20, 28, "Input",ExpressionUUID->"2578517b-ee19-48f6-b076-c0d0bd155acb"],
Cell[5989, 173, 361, 8, 28, "Input",ExpressionUUID->"20c189ec-089c-408f-883e-55eddc84a061"],
Cell[6353, 183, 221, 4, 28, "Input",ExpressionUUID->"047fb61e-9a0f-4f38-89c0-477fa5dc2e45"],
Cell[CellGroupData[{
Cell[6599, 191, 281, 6, 28, "Input",ExpressionUUID->"6ecba3c7-334e-406e-a4d1-72aa9ad9e8a7"],
Cell[6883, 199, 1391, 20, 166, "Output",ExpressionUUID->"156e6e2c-68b7-4dfb-a955-8a9933ebdec6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8311, 224, 1028, 27, 86, "Input",ExpressionUUID->"678c5c34-0ec1-4337-9992-37dd54551eb5"],
Cell[9342, 253, 1677, 53, 84, "Output",ExpressionUUID->"a5b95866-f945-46f3-aa84-9fe350d2d1c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11056, 311, 289, 6, 28, "Input",ExpressionUUID->"44161e21-70ff-4b77-8eb8-d7475788cbac"],
Cell[11348, 319, 384, 9, 32, "Output",ExpressionUUID->"e556a01c-8b79-42fc-8742-6185a2beff63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11769, 333, 274, 5, 28, "Input",ExpressionUUID->"e70d0437-747b-4e30-98a2-2877dfbf8668"],
Cell[12046, 340, 345, 8, 32, "Output",ExpressionUUID->"d2e486ef-9b75-46de-ba3c-e1d103224cfd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12428, 353, 310, 6, 28, "Input",ExpressionUUID->"c2118bf5-95b7-49bb-87f5-a780ec88f93c"],
Cell[12741, 361, 1442, 47, 84, "Output",ExpressionUUID->"45f2d538-4e94-4945-8b6f-ce73f198e231"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14220, 413, 210, 3, 28, "Input",ExpressionUUID->"d8fd1d1e-1a16-46bb-ba37-aab144a9564b"],
Cell[14433, 418, 149, 2, 32, "Output",ExpressionUUID->"8df7532e-086d-49d8-b392-d3efc2220690"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14619, 425, 1022, 23, 86, "Input",ExpressionUUID->"fe3cea40-eeb5-416d-9105-1599584f7532"],
Cell[15644, 450, 899, 20, 192, "Output",ExpressionUUID->"42dfd50d-a987-45a0-b273-723d65304643"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16580, 475, 257, 4, 28, "Input",ExpressionUUID->"6396f468-abf8-4a84-9eaa-3af470af5949"],
Cell[16840, 481, 302, 5, 32, "Output",ExpressionUUID->"14a62c8e-265c-4006-bfc2-e45d074e71e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17179, 491, 203, 3, 28, "Input",ExpressionUUID->"b62eb94f-2922-4e6d-9026-13b31c1183ec"],
Cell[17385, 496, 248, 3, 32, "Output",ExpressionUUID->"6c39006d-05f4-4d9f-ac7f-83a3a4af6a49"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17670, 504, 494, 10, 28, "Input",ExpressionUUID->"5aca2d0b-d32a-4059-a1cb-0000c24ba1e5"],
Cell[18167, 516, 317, 4, 32, "Output",ExpressionUUID->"18129f25-7978-454f-be83-bf87b715f0a2"]
}, Open  ]],
Cell[18499, 523, 324, 7, 28, "Input",ExpressionUUID->"49eb3064-eff9-4be0-b33a-bffde7e8db03"],
Cell[18826, 532, 897, 22, 67, "Input",ExpressionUUID->"dc90e001-d29c-46be-bce9-33173315d99a"],
Cell[CellGroupData[{
Cell[19748, 558, 257, 4, 28, "Input",ExpressionUUID->"4ddc1206-b6bc-4050-ad3d-40331b7f2904"],
Cell[20008, 564, 252, 4, 32, "Output",ExpressionUUID->"209d1212-c798-4f1e-9a79-9f14935ea083"]
}, Open  ]],
Cell[20275, 571, 342, 8, 28, "Input",ExpressionUUID->"2bebf0d9-d374-47d0-aa28-2c44df36a366"],
Cell[20620, 581, 597, 12, 48, "Input",ExpressionUUID->"3094f731-4e6d-433a-8f57-769431b0821f"],
Cell[CellGroupData[{
Cell[21242, 597, 466, 13, 28, "Input",ExpressionUUID->"81a45fa6-acd3-4eff-962c-0e38c7f7e0c8"],
Cell[21711, 612, 511, 8, 32, "Output",ExpressionUUID->"73870257-251a-488a-b803-9006d31e975d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22259, 625, 465, 13, 28, "Input",ExpressionUUID->"8b4f736b-4f3d-4c26-9803-650f5cdc7ea4"],
Cell[22727, 640, 238, 4, 32, "Output",ExpressionUUID->"ada44444-c75c-4262-988e-cc5fa8ef6479"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23002, 649, 462, 13, 28, "Input",ExpressionUUID->"be11e328-bea0-4d50-a1fe-9c4b6da5959c"],
Cell[23467, 664, 417, 8, 32, "Output",ExpressionUUID->"cf659d53-f6a3-4bb3-bf0f-9de42e430ad0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23921, 677, 812, 22, 48, "Input",ExpressionUUID->"040f0077-d1d3-4039-9976-4145a6c7acf0"],
Cell[24736, 701, 317, 5, 32, "Output",ExpressionUUID->"1d9d4ae3-a64b-42a4-b659-7ce48f33fcd8"]
}, Open  ]],
Cell[25068, 709, 628, 17, 48, "Input",ExpressionUUID->"735e2752-6c4d-49b5-8a3e-34f107867fe5"],
Cell[25699, 728, 339, 8, 28, "Input",ExpressionUUID->"de99fece-f95c-493f-97ab-82822b31bb6c"],
Cell[26041, 738, 147, 3, 48, "Input",ExpressionUUID->"573b6bb4-8e3d-41bb-8e80-da6e72455e4f"],
Cell[26191, 743, 221, 4, 28, "Input",ExpressionUUID->"8c9bc2df-c6f7-4b70-93bb-c33dada1533c"],
Cell[26415, 749, 2037, 37, 28, "Input",ExpressionUUID->"bc9eccf5-77d3-4c82-8df2-2bf487eaa43e"],
Cell[28455, 788, 1015, 24, 28, "Input",ExpressionUUID->"a90f8cff-019b-4b5a-9ae5-acf70ca9b0d7"],
Cell[29473, 814, 1528, 26, 48, "Input",ExpressionUUID->"33041250-f101-4837-9c2a-f26a1e084049"],
Cell[31004, 842, 302, 7, 28, "Input",ExpressionUUID->"9c0cc924-4f18-44d1-b0f6-5e92af1bb3f2"],
Cell[CellGroupData[{
Cell[31331, 853, 220, 4, 28, "Input",ExpressionUUID->"b87ba9dd-1bb0-4425-94ac-5463755e053e"],
Cell[31554, 859, 420, 8, 32, "Output",ExpressionUUID->"56b07ed1-cbef-477a-ae02-3d3604fa48ac"]
}, Open  ]],
Cell[31989, 870, 605, 16, 28, "Input",ExpressionUUID->"93e9d11d-78da-4248-87ce-fd925f739f39"],
Cell[32597, 888, 402, 12, 28, "Input",ExpressionUUID->"8453237d-8417-4c98-85e6-77a939991323"],
Cell[33002, 902, 334, 8, 28, "Input",ExpressionUUID->"a7f65ea9-07dd-4c1c-ada5-d41b2e5b79cd"],
Cell[33339, 912, 280, 5, 28, "Input",ExpressionUUID->"0611f0c7-40bc-4139-824e-8ce4ab5a6749"],
Cell[33622, 919, 2924, 69, 238, "Input",ExpressionUUID->"b1d9d6a1-7afe-4eb8-8230-57c15443679c"],
Cell[36549, 990, 477, 10, 28, "Input",ExpressionUUID->"e7ad441f-3299-4a3c-8eda-d73b0fabab45"],
Cell[CellGroupData[{
Cell[37051, 1004, 597, 16, 48, "Input",ExpressionUUID->"1767f6bd-80e8-4502-b536-ef6378470f27"],
Cell[37651, 1022, 3701, 91, 384, "Output",ExpressionUUID->"9053efaf-5572-43dd-9c9a-4aa983901bd7"]
}, Open  ]]
}
]
*)

